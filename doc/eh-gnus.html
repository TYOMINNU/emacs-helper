<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN">
<head>
<title>eh-gnus配置说明</title>
<!-- 2014-11-22 六 17:15 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Feng Shu" />
<link rel="stylesheet" type="text/css" href="./style/worg.css" />
<link rel="alternate stylesheet" type="text/css" href="style2.css" />
</head>
<body>
<div id="content">
<h1 class="title">eh-gnus配置说明</h1>
<div id="table-of-contents">
<h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. 显摆gnus截图</a>
<ul>
<li><a href="#sec-1-1">1.1. gnus组名称列表（group buffer）</a></li>
<li><a href="#sec-1-2">1.2. gnus新闻标题列表（summary buffer）</a></li>
<li><a href="#sec-1-3">1.3. gnus新闻标题+正文（summary buffer + article buffer）</a></li>
</ul>
</li>
<li><a href="#sec-2">2. 解释配置原理</a></li>
<li><a href="#sec-3">3. 设定基本信息</a>
<ul>
<li><a href="#sec-3-1">3.1. 邮箱访问设置</a></li>
<li><a href="#sec-3-2">3.2. 本机设置</a></li>
<li><a href="#sec-3-3">3.3. dovecot设置</a></li>
</ul>
</li>
<li><a href="#sec-4">4. 安装辅助程序</a></li>
<li><a href="#sec-5">5. 配置辅助程序</a>
<ul>
<li><a href="#sec-5-1">5.1. msmtp</a></li>
<li><a href="#sec-5-2">5.2. dovecot</a></li>
<li><a href="#sec-5-3">5.3. offlineimap (与isync两者选一）</a></li>
<li><a href="#sec-5-4">5.4. isync（与offlineimap两者选一）</a></li>
<li><a href="#sec-5-5">5.5. leafnode</a></li>
<li><a href="#sec-5-6">5.6. rss2email</a></li>
</ul>
</li>
<li><a href="#sec-6">6. cron配置</a></li>
<li><a href="#sec-7">7. gnus配置</a></li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> 显摆gnus截图</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> gnus组名称列表（group buffer）</h3>
<div class="outline-text-3" id="text-1-1">

<div class="figure">
<p><img src="./images/gnus-group.png" alt="gnus-group.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> gnus新闻标题列表（summary buffer）</h3>
<div class="outline-text-3" id="text-1-2">

<div class="figure">
<p><img src="./images/gnus-summary1.png" alt="gnus-summary1.png" />
</p>
</div>


<div class="figure">
<p><img src="./images/gnus-summary2.png" alt="gnus-summary2.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> gnus新闻标题+正文（summary buffer + article buffer）</h3>
<div class="outline-text-3" id="text-1-3">

<div class="figure">
<p><img src="./images/gnus-summary+article.png" alt="gnus-summary+article.png" />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> 解释配置原理</h2>
<div class="outline-text-2" id="text-2">

<div class="figure">
<p><img src="images/gnus配置基本原理.png" alt="gnus配置基本原理.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> 设定基本信息</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> 邮箱访问设置</h3>
<div class="outline-text-3" id="text-3-1">
<ol class="org-ol">
<li>邮箱地址: <code>YOUREMAIL@gmail.com</code>
</li>
<li>邮箱密码: <code>YOURPASSWORD</code>
</li>
<li>smtp服务器地址: <code>smtp.gmail.com</code>
</li>
<li>smtp服务器端口: <code>587</code>
</li>
<li>imap服务器地址: <code>imap.gmail.com</code>
</li>
<li>imap服务器端口: <code>993</code>
</li>
</ol>
</div>
</div>
<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> 本机设置</h3>
<div class="outline-text-3" id="text-3-2">
<ol class="org-ol">
<li>本机登陆用户: <code>feng</code>
</li>
<li>HOME目录: <code>/home/feng</code>
</li>
</ol>
</div>
</div>
<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> dovecot设置</h3>
<div class="outline-text-3" id="text-3-3">
<ol class="org-ol">
<li>email保存目录:  <code>/home/feng/maildir</code>
</li>
<li>dovecot常规邮件保存账户: <code>myemail</code>
</li>
<li>dovecot常规邮件保存账户密码: <code>myemail-password</code>
</li>
<li>dovecot rss订阅邮件保存账户: <code>myrss</code>
</li>
<li>dovecot rss订阅邮件保存账户: <code>myrss-password</code>
</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> 安装辅助程序</h2>
<div class="outline-text-2" id="text-4">
<p>
安装msmtp, offlineimap, isync, leafnode, dovecot
</p>
<div class="org-src-container">

<pre class="src src-org">sudo apt-get install msmtp msmtp-gnome offlineimap isync leafnode dovecot-core dovecot-imapd
</pre>
</div>

<p>
Debian 7软件库中的html2test和feedparser版本太低，只能使用其他方式安装rss2email
</p>

<p>
首先： 安装easy_install和easy_install3。
</p>

<div class="org-src-container">

<pre class="src src-org">sudo apt-get install python3-setuptools
</pre>
</div>

<p>
然后： 使用easy_install3安装rss2email。注意： rss2email使用python3。
</p>

<div class="org-src-container">

<pre class="src src-org">sudo easy_install3 html2text
sudo easy_install3 feedparser
sudo easy_insatll3 rss2email
</pre>
</div>

<p>
rss2email使用base64编码中文，procmail处理起来非常费事，我这里使用一个拼音后处理插件，在rss转化为邮件的过程中，自动添加两个邮件field：X-Translate-From 和 X-Translate-Subject，用来保存Subject和From中文字符串的拼音，这样就可以在procmailrc中使用拼音来分类rss。
</p>

<p>
将rss2email_post_hooks所在的目录添加到PYTHONPATH（语法与shell里面的PATH一样），将下面一行代码写入~/.bashrc文件。
</p>
<div class="org-src-container">

<pre class="src src-org">export PYTHONPATH=$PYTHONPATH:/home/feng/project/emacs-packages/emacs-helper/other/rss2email-template/
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> 配置辅助程序</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1"><span class="section-number-3">5.1</span> msmtp</h3>
<div class="outline-text-3" id="text-5-1">
<p>
msmpt配置文件~/.msmptrc的内容如下：
</p>
<div class="org-src-container">

<pre class="src src-org" id="msmtprc">defaults
tls on
tls_certcheck off
tls_starttls on

account default
host smtp.gmail.com
domain smtp.gmail.com
tls on
tls_certcheck off
tls_starttls on
auth on
user YOUREMAIL@gmail.com
from YOUREMAIL@gmail.com
<span id="coderef-password" class="coderef-off">password YOURPASSWORD</span>
port 587
logfile ~/.msmtp.log
</pre>
</div>

<p>
上述配置中保存邮箱的 <b>明文密码</b> ，安全性相对较低<a href="#coderef-password"class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-password');" onmouseout="CodeHighlightOff(this, 'coderef-password');">15</a>，如果需要较高的安全性，可以使用smtp-gnome，将邮箱帐号密码保存到gnome-key-ring中。同时要删除或者注释掉password一行<a href="#coderef-password"class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-password');" onmouseout="CodeHighlightOff(this, 'coderef-password');">15</a>。
</p>
<div class="org-src-container">

<pre class="src src-org">cd  /usr/share/doc/msmtp-gnome/scripts/
python ./msmtp-gnome-tool.py --username=YOUREMAIL@gmail.com --server=smtp.gmail.com
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2"><span class="section-number-3">5.2</span> dovecot</h3>
<div class="outline-text-3" id="text-5-2">
<p>
dovecot的配置文件： /etc/dovecot/dovecot.conf
</p>
<div class="org-src-container">

<pre class="src src-org">protocols = imap

<span style="color: #8B8989; font-style: italic;"># It's nice to have separate log files for Dovecot. You could do this</span>
<span style="color: #8B8989; font-style: italic;"># by changing syslog configuration also, but this is easier.</span>
log_path = /var/log/dovecot.log
info_log_path = /var/log/dovecot-info.log

<span style="color: #8B8989; font-style: italic;"># Disable SSL for now.</span>
ssl = no
disable_plaintext_auth = no

<span style="color: #8B8989; font-style: italic;"># We're using Maildir format</span>
mail_location = maildir:/home/feng/maildir/%u

<span style="color: #8B8989; font-style: italic;"># Authentication configuration:</span>
auth_verbose = yes
auth_mechanisms = plain

passdb {
  driver = password-file
  args = /etc/dovecot/password
}
userdb {
  driver = static
  args = uid=feng gid=feng home=/home/feng/maildir/.home/%u
}
</pre>
</div>

<p>
与dovecot配置文件对应的password文件： /etc/devecot/password
</p>

<div class="org-src-container">

<pre class="src src-org">myemail:{plain}myemail-password:feng:feng::/home/feng/maildir/.home/myemail::userdb_mail=maildir:/home/feng/maildir/myemail
myrss:{plain}myrss-password:feng:feng::/home/feng/maildir/.home/myrss::userdb_mail=maildir:/home/feng/maildir/myrss
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3"><span class="section-number-3">5.3</span> offlineimap (与isync两者选一）</h3>
<div class="outline-text-3" id="text-5-3">
<p>
offlineimap配置文件:  ~/.offlineimaprc
</p>
<div class="org-src-container">

<pre class="src src-org">[general]
accounts = default-email-account
pythonfile = .offlineimap.py
ui = quiet

[Account default-email-account]
localrepository = LocalIMAP
remoterepository = RemoteIMAP
<span style="color: #8B8989; font-style: italic;"># autorefresh = 3</span>

[Repository LocalIMAP]
type = IMAP
remotehost = localhost
remoteuser = myemail
remotepass = myemail-password
holdconnectionopen = yes

[Repository RemoteIMAP]
type = IMAP
remotehost = imap.gmail.com
remoteuser = YOUREMAIL@gmail.com
<span style="color: #8B8989; font-style: italic;"># &#23433;&#35013;&#21253;python-keyring,&#28982;&#21518;&#20351;&#29992;&#19979;&#30340;&#21629;&#20196;&#20445;&#23384;&#23494;&#30721;&#12290;</span>
<span style="color: #8B8989; font-style: italic;"># import keyring</span>
<span style="color: #8B8989; font-style: italic;"># keyring.set_password("imap.gmail.com","YOUREMAIL@gmail.com", "YOURPASSWORD")</span>
<span style="color: #8B8989; font-style: italic;"># remotepasseval = keyring.get_password("imap.gmail.com","YOUREMAIL@gmail.com")</span>
remotepass = YOURPASSWORD
ssl = yes
cert_fingerprint=f3043dd689a2e7dddfbef82703a6c65ea9b634c1
maxconnections = 3
realdelete = no
<span style="color: #8B8989; font-style: italic;"># holdconnectionopen = true</span>
<span style="color: #8B8989; font-style: italic;"># keepalive = 60</span>

<span style="color: #8B8989; font-style: italic;"># nametrans = lambda folder: re.sub('.*Spam$', 'Spam',</span>
<span style="color: #8B8989; font-style: italic;">#         re.sub('.*Drafts$', 'Drafts',</span>
<span style="color: #8B8989; font-style: italic;">#         re.sub('.*Sent Mail$', 'Sent',</span>
<span style="color: #8B8989; font-style: italic;">#         re.sub('.*Starred$', 'Flagged',</span>
<span style="color: #8B8989; font-style: italic;">#         re.sub('.*Trash$', 'Trash',</span>
<span style="color: #8B8989; font-style: italic;">#         re.sub('.*All Mail$', 'Archive', folder))))))</span>
folderfilter = lambda foldername: not re.search('(Trash|Del|Archive|All Mail|Spam|Chats)', foldername)
</pre>
</div>

<p>
可以在桌面添加offlineimap的启动图标，双击图标后开始同步邮件：
</p>

<p>
保存下面的配置到文件:  ~/.local/share/Application/offlineimap.desktop
</p>
<div class="org-src-container">

<pre class="src src-org">[Desktop Entry]
Exec="x-terminal-emulator " "-e" "start_daemon -n19 -c2 -p7 python2.7 offlineimap"
Icon=/home/feng/Picture/icons/offlineimap.png
Name=OfflineIMAP
Encoding=UTF-8
Terminal=false
Type=Application
Categories=Application;Network;
</pre>
</div>

<p>
offlineimap启动器：start-daemon.sh
</p>
<div class="org-src-container">

<pre class="src src-org">#!/bin/sh

set -efu

ionice_class=
ionice_priority=
nice=

while getopts c:p:n: f; do
	case $f in
	c) ionice_class=$OPTARG;;
	p) ionice_priority=$OPTARG;;
	n) nice=$OPTARG;;
	*) exit 2;;
	esac
done
shift $((OPTIND - 1))

cmd=$*
io=

if pgrep -u "$(id -u)" -xf -- "$cmd" &gt;/dev/null 2&gt;&amp;1; then
	exit 0
fi

if type ionice &gt;/dev/null 2&gt;&amp;1; then
	[ -n "$ionice_class" ]    &amp;&amp; { io=1; cmd="-c $ionice_class $cmd"; }
	[ -n "$ionice_priority" ] &amp;&amp; { io=1; cmd="-n $ionice_priority $cmd"; }
	[ -n "$io" ] &amp;&amp; cmd="ionice $cmd"
fi

if type nice &gt;/dev/null 2&gt;&amp;1; then
	[ -n "$nice" ] &amp;&amp; cmd="nice -n $nice $cmd"
fi

exec $cmd
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-4" class="outline-3">
<h3 id="sec-5-4"><span class="section-number-3">5.4</span> isync（与offlineimap两者选一）</h3>
<div class="outline-text-3" id="text-5-4">
<p>
isync配置文件： ~/.mbsyncrc
</p>
<div class="org-src-container">

<pre class="src src-org">IMAPAccount remote-email-account
Host imap.gmail.com
User YOUREMAIL@gmail.com
Pass YOURPASSWORD
UseIMAPS yes
<span style="color: #8B8989; font-style: italic;"># RequireSSL yes</span>
<span style="color: #8B8989; font-style: italic;"># You should install package: ca-certificates.</span>
CertificateFile /etc/ssl/certs/ca-certificates.crt

IMAPStore remote-email-store
Account remote-email-account

IMAPAccount local-dovecot-account
Host localhost
User myemail
Pass myemail-password

IMAPStore local-dovecot-store
Account local-dovecot-account

Channel get-default-email
Master :remote-email-store:
Slave :local-dovecot-store:
<span style="color: #8B8989; font-style: italic;"># Exclude everything under the internal [Gmail] folder, except the interesting folders</span>
Patterns * ![Gmail]* "[Gmail]/Sent Mail" "[Gmail]/Starred"
<span style="color: #8B8989; font-style: italic;"># Or include everything</span>
#Patterns *
<span style="color: #8B8989; font-style: italic;"># Automatically create missing mailboxes, both locally and on the server</span>
Create Both
<span style="color: #8B8989; font-style: italic;"># Save the synchronization state files in the relevant directory</span>
SyncState ~/.mbsyncstate/get-default-email

Channel get-all-email
Master :remote-email-store:
Slave :local-dovecot-store:
Patterns "[Gmail]/All Mail"
Create Slave
Sync New
SyncState ~/.mbsyncstate/get-all-email

Channel get-spam-email
Master :gmail-store:
Slave :local-dovecot-store:
Patterns "[Gmail]/Spam"
Create Master
Sync Push
SyncState ~/.mbsyncstate/get-spam-email
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-5" class="outline-3">
<h3 id="sec-5-5"><span class="section-number-3">5.5</span> leafnode</h3>
<div class="outline-text-3" id="text-5-5">
<p>
leafnode运行必须有完整的域名， 如果只将leafnode作为一个news下载器，我们可以设定一个伪造的域名，比如：在debian系统中，我们可以更改/etc/hosts文件：
</p>

<div class="org-src-container">

<pre class="src src-org">127.0.0.1       news.tumashu-localhost.org localhost
127.0.1.1       news.tumashu-localhost.org tumashu

<span style="color: #8B8989; font-style: italic;"># The following lines are desirable for IPv6 capable hosts</span>
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
</pre>
</div>
<p>
注意： 设定域名这个步骤非常关键， 建议重新启动系统，另外系统时间也要设定正确。
</p>

<p>
leafnode配置
</p>
<div class="org-src-container">

<pre class="src src-org">sudo dpkg-reconfigure leafnode
</pre>
</div>
<p>
配置选项选择：
</p>
<ol class="org-ol">
<li>Server to download news from:  (我使用 news.gmane.org)
</li>
<li>Network connection type:   (permanent，一小时下载一次)
</li>
<li>Enable access controls for Leafnode?  (yes)
</li>
<li>Update the list of available groups? (第一次使用建议选yes)
</li>
</ol>

<p>
配置完成后，建议手动下载news:
</p>
<div class="org-src-container">

<pre class="src src-org">sudo /etc/news/leafnode/do-fetch-news
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-6" class="outline-3">
<h3 id="sec-5-6"><span class="section-number-3">5.6</span> rss2email</h3>
<div class="outline-text-3" id="text-5-6">
<p>
rss2email配置文件: ~/.config/rss2email.conf
</p>
<div class="org-src-container">

<pre class="src src-org">[DEFAULT]
from = user@rss2email.invalid
use-8bit = False
force-from = False
use-publisher-email = False
name-format = {feed-title}: {author}
to = feng@localhost
proxy =
feed-timeout = 120
active = True
digest = False
date-header = False
date-header-order = modified, issued, created, expired
bonus-header =
trust-guid = True
trust-link = False
encodings = US-ASCII, ISO-8859-1, UTF-8, BIG5, ISO-2022-JP
post-process = rss2email_post_hooks.pinyin_header add_pinyin_header
digest-post-process =
html-mail = True
use-css = True
css = h1 {
	font: 18pt Georgia, "Times New Roman";
	}
	body {
	font: 12pt Arial;
	}
	a:link {
	font: 12pt Arial;
	font-weight: bold;
	color: #0000cc;
	}
	blockquote {
	font-family: monospace;
	}
	.header {
	background: #e0ecff;
	border-bottom: solid 4px #c3d9ff;
	padding: 5px;
	margin-top: 0px;
	color: red;
	}
	.header a {
	font-size: 20px;
	text-decoration: none;
	}
	.footer {
	background: #c3d9ff;
	border-top: solid 4px #c3d9ff;
	padding: 5px;
	margin-bottom: 0px;
	}
	border: solid 4px #c3d9ff;
	}
	margin-left: 5px;
	margin-right: 5px;
	}
unicode-snob = False
links-after-each-paragraph = False
body-width = 0
email-protocol = sendmail
sendmail = /usr/sbin/sendmail
smtp-auth = False
smtp-username = username
smtp-password = password
smtp-server = smtp.yourisp.net:25
smtp-ssl = False
smtp-ssl-protocol = SSLv3
imap-auth = False
imap-username = username
imap-password = password
imap-server = imap.yourisp.net
imap-port = 143
imap-ssl = False
imap-mailbox = INBOX
verbose = warning

[feed.org-mode.git]
url = <span style="color: #96CBFE; text-decoration: underline;"><a href="http://repo.or.cz/w/org-mode.git/rss">http://repo.or.cz/w/org-mode.git/rss</a></span>

[feed.emacs.git]
url = <span style="color: #96CBFE; text-decoration: underline;"><a href="http://repo.or.cz/w/emacs.git/rss">http://repo.or.cz/w/emacs.git/rss</a></span>

[feed.baidu.internet.news]
url = <span style="color: #96CBFE; text-decoration: underline;"><a href="http://news.baidu.com/n?cmd=1&amp;class=internet&amp;tn=rss">http://news.baidu.com/n?cmd=1&amp;class=internet&amp;tn=rss</a></span>
</pre>
</div>

<p>
procmailrc配置文件: ~/.procmailrc
</p>
<div class="org-src-container">

<pre class="src src-org">## VERBOSE=on
## LOGFILE=$HOME/.procmail.log

:0
<span style="color: #ff1493; font-size: 130%;">* ^From.*Cron Daemon</span>
RSS/.cron-log/

:0
<span style="color: #ff1493; font-size: 130%;">* X-RSS-Feed.*baidu.*class=</span>
{
	:0
	* ^X-Pinyin-Subject.*(apple|pingguo|htc|sanxin)
	Maildir/rss/.news-baidu-mobile/

<span style="color: #FBDE2D;">        :0:</span>
	Maildir/rss/.news-baidu/
}

:0
<span style="color: #ff1493; font-size: 130%;">* ^User-Agent.*rss2email</span>
<span style="color: #ff1493; font-size: 130%;">* ^From.*emacs|Emacs|EMACS</span>
Maildir/rss/.emacs/

:0
<span style="color: #ff1493; font-size: 130%;">* ^User-Agent.*rss2email</span>
Maildir/rss/.others/
</pre>
</div>

<p>
直接使用r2e命令添加rss地址太罗嗦，写一个shell脚本来处理：
</p>
<ol class="org-ol">
<li>保存下面代码到一个目录, 比如： ~/bin/rss2email.sh
</li>
<li>安装firefox扩展： AppLauncher
</li>
<li>配置AppLauncher
<ol class="org-ol">
<li>name:  rss2email
</li>
<li>path:  /usr/bin/x-terminal-emulator
</li>
<li>arguments: &#x2013;command=~/bin/rss2email.sh &amp;url
</li>
</ol>
</li>
</ol>

<div class="org-src-container">

<pre class="src src-org">#!/bin/bash

echo "The Feed url is: $1"
echo "Please enter a name for this feed"
read feed_name
echo "run command: r2e add $feed_name $1"
r2e add $feed_name $1
r2e list
echo "Wait 10 second or press C-c to quit."
read -t 10
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> cron配置</h2>
<div class="outline-text-2" id="text-6">
<p>
在shell中运行crontab命令：
</p>
<div class="org-src-container">

<pre class="src src-org">crontab -e
</pre>
</div>

<p>
然后添加如下内容： 设定5分钟运行一次offlineimap，1个小时运行一下rss2email。
</p>
<div class="org-src-container">

<pre class="src src-org">PYTHONPATH=/home/feng/project/emacs-packages/emacs-helper/other/rss2email-template/
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/bin:/usr/local/games:/usr/games

*/5 * * * * /usr/local/bin/start_daemon -n19 -c2 -p7 python2.7 /usr/bin/offlineimap &gt;/dev/null 2&gt;&amp;1
0 */1 * * * /usr/local/bin/r2e run
### DON'T REMOVE THIS LINE ###
</pre>
</div>

<p>
然后运行命令：
</p>
<div class="org-src-container">

<pre class="src src-org">sudo /etc/init.d/cron restart
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> gnus配置</h2>
<div class="outline-text-2" id="text-7">
<p>
调整eh-gnus.el文件中如下几行：
</p>
<div class="org-src-container">

<pre class="src src-elisp">(setq gnus-select-method
      '(nnimap <span style="color: #61CE3C;">"myemail"</span>
	       (nnimap-address <span style="color: #61CE3C;">"localhost"</span>)
	       (nnimap-stream network)))

(add-to-list 'gnus-secondary-select-methods
	     '(nnimap <span style="color: #61CE3C;">"myrss"</span>
		      (nnimap-address <span style="color: #61CE3C;">"localhost"</span>)
		      (nnimap-stream network)))

(add-to-list 'gnus-secondary-select-methods
	     '(nntp <span style="color: #61CE3C;">"localhost"</span>))
</pre>
</div>

<p>
然后运行gnus。
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">&#20316;&#32773;: Feng Shu</p>
<p class="date">Created: 2014-11-22 六 17:15</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.0.50.1 (<a href="http://orgmode.org">Org</a> mode 8.3beta)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
